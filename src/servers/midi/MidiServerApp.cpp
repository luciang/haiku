/**
 * @file MidiServerApp.cpp
 *
 * @author Matthijs Hollemans
 * @author Jerome Leveque
 */

#include <Alert.h>

#include "MidiServerApp.h"

//------------------------------------------------------------------------------
//Constructor
MidiServerApp::MidiServerApp()
	: BApplication("application/x-vnd.obos-midi-roster")
{
	roster = new BMidiRoster();
}

//------------------------------------------------------------------------------
//Destructor
MidiRosterApp::	~MidiRosterApp(void)
{//ToTest
	delete EndPointList;
}

//------------------------------------------------------------------------------

void MidiServerApp::AboutRequested()
{
	(new BAlert(0,
		"-write something funny here-",
		"Okay", 0, 0, B_WIDTH_AS_USUAL, 
		B_INFO_ALERT))->Go();
}

//------------------------------------------------------------------------------

void MidiServerApp::MessageReceived(BMessage *msg)
{//ToDo
	switch (msg->what)
	{
		default : BApplication::MessageReceived(msg);
	}
}

//------------------------------------------------------------------------------

int32 MidiServerApp::GetNextFreeID(void)
{//ToTest
	return NextFreeID++;
}

//------------------------------------------------------------------------------

BMidiEndpoint *MidiServerApp::NextEndPoint(int32 *id)
{//ToTest
int32 item = 0;
BMidiEndpoint *endpoint;
	while ((endpoint = (BMidiEndpoint*)EndPointList->ItemAt(item)) != NULL)
	{
		if (endpoint->ID() > *id)
		{
			endpoint->Acquire();
			*id = endpoint->ID();
			return endpoint;
		}
		item++;
	}
return NULL;
}

//------------------------------------------------------------------------------

BMidiRoster *MidiServerApp::GetRoster()
{
	return roster;
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------

int main()
{
	MidiServerApp app;
	app.Run();
	return 0;
}

//------------------------------------------------------------------------------

