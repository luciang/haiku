SubDir OBOS_TOP src tests kernel core disk_device_manager ;

#UsePrivateHeaders $(DOT) ;
UsePrivateHeaders shared ;
UsePrivateHeaders [ FDirName kernel disk_device_manager ] ;
UsePrivateHeaders [ FDirName kernel util ] ;
UsePrivateHeaders storage ;
UseHeaders [ FDirName $(OBOS_TOP) src kernel core disk_device_manager ] ;

SimpleTest DiskDeviceManagerTest
	: DiskDeviceManagerTest.cpp

	: <boot!home!config!lib>libdisk_device_manager.so be
;

AbsSymLink <boot!home!config!lib>libdisk_device_manager.so
	: libdisk_device_manager.so : /boot/home/config/lib ;

Depends DiskDeviceManagerTest : <boot!home!config!lib>libkernelland_emu.so ;

# Also build all modules:
Depends DiskDeviceManagerTest : userland_disk_system_modules ;

# Pseudo target for disk system modules.
NotFile userland_disk_system_modules ;
Depends userland_disk_system_modules :
	<boot!home!config!lib>libkernelland_emu.so
	<file_system>bfs
	<partitioning_system>intel
	<partitioning_system>amiga_rdb
	<partitioning_system>apple
	<partitioning_system>session
;

