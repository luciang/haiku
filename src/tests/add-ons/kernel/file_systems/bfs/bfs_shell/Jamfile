SubDir OBOS_TOP src tests add-ons kernel file_systems bfs bfs_shell ;

SubDirHdrs $(OBOS_TOP) src tests add-ons kernel file_systems fs_shell ;
SubDirHdrs $(OBOS_TOP) src add-ons kernel file_systems bfs ;

{
	local defines = [ FDefines USER DEBUG ] ; # _NO_INLINE_ASM
	SubDirCcFlags $(defines) -fno-exceptions -fno-rtti ; #-fcheck-memory-usage
	SubDirC++Flags $(defines) -fno-exceptions -fno-rtti ; #-fcheck-memory-usage
}

SimpleTest bfs_shell
	:
	fsh.c rootfs.c initfs.c kernel.c cache.c sl.c stub.c
	sysdep.c hexdump.c argv.c

	Volume.cpp BPlusTree.cpp Inode.cpp Index.cpp Query.cpp Journal.cpp
	BlockAllocator.cpp kernel_interface.cpp Utility.cpp BufferPool.cpp
	Debug.cpp cpp.cpp
	:
	;

# Tell Jam where to find these sources
SEARCH on [ FGristFiles
		Volume.cpp BPlusTree.cpp Inode.cpp Index.cpp Query.cpp Journal.cpp
		BlockAllocator.cpp kernel_interface.cpp Utility.cpp BufferPool.cpp
		Debug.cpp cpp.cpp
	] = [ FDirName $(OBOS_TOP) src add-ons kernel file_systems bfs ] ;

SEARCH on [ FGristFiles
		fsh.c rootfs.c initfs.c kernel.c cache.c sl.c stub.c
		sysdep.c hexdump.c argv.c
	] = [ FDirName $(OBOS_TOP) src tests add-ons kernel file_systems fs_shell ] ;
