SubDir OBOS_TOP src tests servers registrar ;

SimpleTest RegistrarTest1
	: RegistrarTest1.cpp
	: <boot!home!config!lib>libopenbeos.so be
;

# RosterShell isn't really a unit test, but using CommonUnitTest we can
# easily build a R5 version as well, which is quite useful. We'll have to
# change it back, when we start dealing with (OBOS) roster internals (if
# ever).

#SimpleTest RosterShell
#	: RosterShell.cpp
#	: <boot!home!config!lib>libopenbeos.so
#	  be stdc++.r4
#;

CommonUnitTest RosterShell
	: RosterShell.cpp
	: servers registrar
	: <boot!home!config!lib>libopenbeos.so be stdc++.r4
	: be stdc++.r4
	: app
;

SimpleTest message_deliverer_test : message_deliverer_test.cpp
	: <boot!home!config!lib>libopenbeos.so ;


SimpleTest run_haiku_registrar
	: run_haiku_registrar.cpp
	: be
;

# a shutdown working with the emulation under R5
if $(TARGET_PLATFORM) = r5 {
	UsePrivateHeaders app ;
	UsePrivateHeaders kernel ;

	SimpleTest <test>shutdown
		: shutdown.cpp
		: <boot!home!config!lib>libopenbeos.so ;
	
	SEARCH on [ FGristFiles shutdown.cpp ] = [ FDirName $(OBOS_TOP) src bin ] ;
}

# Two small test apps for testing the shutdown process.

local libbe ;
if $(TARGET_PLATFORM) = r5 {
	libbe = libopenbeos.so ;
} else {
	libbe = be ;
}

SimpleTest no_shutdown_reply
	: no_shutdown_reply.cpp
	: $(libbe)
;

SimpleTest negative_shutdown_reply
	: negative_shutdown_reply.cpp
	: $(libbe)
;

SimpleTest user_shutdown_reply
	: user_shutdown_reply.cpp
	: $(libbe)
;

