SubDir HAIKU_TOP src apps abouthaiku ;

UsePrivateHeaders shared ;

if $(TARGET_PLATFORM) = r5 {
	SubDirC++Flags -DR5_COMPATIBLE ;
}

Application AboutHaiku :
	AboutHaiku.cpp
	: libbe.so libtranslation.so libroot.so
	: AboutHaiku.rdef
	;

rule AddRevisionToResources {
	Depends $(1) ;
	AddRevisionToResources1 $(1) : <build>rc ;
}

actions AddRevisionToResources1 {
	VERSION=`svn info | grep Revision | cut -d\  -f2`
	echo "resource(201, \"SVN:REVISION\") #'CSTR' \""$VERSION"\";" | $(2) -m -o $(1) -
}

# This must come after the Application rule, so that the
# AboutHaiku.rsrc file is already created
AddRevisionToResources [ FGristFiles AboutHaiku.rsrc ] ;
ALWAYS [ FGristFiles AboutHaiku.rsrc ] ;
	# we want to rebuild the resources everytime AboutHaiku
	# is built to keep them up-to-date

Includes [ FGristFiles AboutHaiku.rdef ] : [ FGristFiles haikulogo.png ] ;
SEARCH on [ FGristFiles haikulogo.png ] = [ FDirName $(HAIKU_TOP) src apps abouthaiku ] ;

