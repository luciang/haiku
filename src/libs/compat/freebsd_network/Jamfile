SubDir HAIKU_TOP src libs compat freebsd_network ;


UseHeaders [ FDirName $(SUBDIR) ] : true ;
UseHeaders [ FDirName $(SUBDIR) compat ] : true ;
UsePrivateHeaders net ;
UsePrivateKernelHeaders ;
UseHeaders $(HAIKU_PRIVATE_KERNEL_HEADERS) : true ;

SubDirCcFlags [ FDefines _KERNEL=1 ] ;

KernelStaticLibrary libfreebsd_network.a :
	bus.c
	callout.c
	compat.c
	device.c
	driver.c
	eventhandler.c
	fbsd_busdma_x86.c
	fbsd_ether.c
	fbsd_if_media.c
	fbsd_mbuf.c
	fbsd_mii.c
	fbsd_mii_physubr.c
	if.c
	mbuf.c
	mii.c
	mutex.c
	taskqueue.c
	;

rule MIIHeaderGen
{
	SEARCH on $(2) = [ FDirName $(SUBDIR) compat dev mii ] ;
	SEARCH on $(3) = $(SEARCH_SOURCE) ;

	Depends $(1) : $(2) $(3) ;
	MakeLocateArch $(<) ;
	MIIHeaderGen1 $(1) : $(2) $(3) ;
	LocalClean clean : $(<) ;
}

actions MIIHeaderGen1
{
	gawk -v HEADERFILE=$(1) -f $(2[2]) $(2[1])
}

MIIHeaderGen [ FGristFiles miidevs.h ] : miidevs : miidevs2h.awk ;

