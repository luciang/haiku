SubDir HAIKU_TOP src kits media ;

SetSubDirSupportedPlatformsBeOSCompatible ;

if $(TARGET_PLATFORM) != haiku {
	UseHeaders [ FDirName $(HAIKU_TOP) headers os media ] : true ;
		# We need the public media headers also when not compiling for Haiku.
	UseHeaders [ FDirName $(HAIKU_TOP) headers os ] : true ;
		# We need the public headers also when not compiling for Haiku.
	UseHeaders [ FDirName $(HAIKU_TOP) headers posix ] : true ;
		# We need the public posix headers also when not compiling for Haiku.
	UseHeaders [ FDirName $(HAIKU_TOP) headers os support ] : true ;
		# We need the public support headers also when not compiling for Haiku.
	UseHeaders [ FDirName $(HAIKU_TOP) headers os app ] : true ;
		# We need the public app headers also when not compiling for Haiku.
}

UsePrivateHeaders media shared ;

if $(CHECK_MALLOC) {
	SubDirC++Flags -D_NO_INLINE_ASM -fcheck-memory-usage ;
}

# That's ugly. The header (ServerInterface.h) should reside in
# headers/private/media.
SubDirHdrs [ FDirName $(HAIKU_TOP) src servers media ] ;
SubDirSysHdrs $(SUBDIR) ; # for the Old*.h headers

SharedLibrary libmedia.so :
	# Private Media Kit
	!missing_symbols.cpp

	# Public Media Kit
	Buffer.cpp
	BufferConsumer.cpp
	BufferGroup.cpp
	BufferProducer.cpp
	Controllable.cpp
	FileInterface.cpp
	MediaAddOn.cpp
	MediaDecoder.cpp
	MediaDefs.cpp
	MediaEncoder.cpp
	MediaEventLooper.cpp
	MediaFile.cpp
	MediaFiles.cpp
	MediaFormats.cpp
	MediaNode.cpp
	MediaRoster.cpp
	MediaTheme.cpp
	MediaTrack.cpp
	ParameterWeb.cpp
	PlaySound.cpp
	RealtimeAlloc.cpp
	Sound.cpp
	SoundFile.cpp
	SoundPlayer.cpp
	TimeCode.cpp
	TimedEventQueue.cpp
	TimeSource.cpp

	# Internal Functionality
	BufferIdCache.cpp
	DataExchange.cpp
	DefaultMediaTheme.cpp
	DormantNodeManager.cpp
	Notifications.cpp
	PortPool.cpp
	SharedBufferList.cpp
	TrackReader.cpp
	TimedEventQueuePrivate.cpp
	TimeSourceObject.cpp
	TimeSourceObjectManager.cpp
	SoundPlayNode.cpp

	# Old (R3) Media Kit
	OldAudioModule.cpp
	OldAudioStream.cpp
	OldBufferStream.cpp
	OldBufferStreamManager.cpp
	OldMediaModule.cpp
	OldSoundFile.cpp
	OldSubscriber.cpp
	
	# Codec Plugin API
	ChunkCache.cpp
	DecoderPlugin.cpp
	MediaExtractor.cpp
	MediaPlugin.cpp
	PluginManager.cpp
	ReaderPlugin.cpp
	:
	be
;
