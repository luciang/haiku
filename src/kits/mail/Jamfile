SubDir OBOS_TOP src kits mail ;

UsePrivateHeaders mail ;

SubDirHdrs [ FDirName $(OBOS_TOP) headers os add-ons mail_daemon ] ;

if $(CHECK_MALLOC) {
	SubDirC++Flags -D_NO_INLINE_ASM -fcheck-memory-usage ;
}

if $(TARGET_PLATFORM) = r5 {
	SubDirC++Flags -DBUILDING_R5_LIBNET ;
} else {
	SubDirC++Flags -DBONE ;
}

SubDirC++Flags -D_BUILDING_mail=1 -DUSE_NASTY_SYNC_THREAD_HACK=1 ;

SharedLibrary mail :
	b_mail_message.cpp
	c_mail_api.cpp
	ChainRunner.cpp
	cpp_abi_base64.c
	crypt.cpp
	des.c
	ErrorLogWindow.cpp
	FileConfigView.cpp
	mail_encoding.c
	mail_util.cpp
	MailAddon.cpp
	MailAttachment.cpp
	MailChain.cpp
	MailComponent.cpp
	MailContainer.cpp
	MailDaemon.cpp
	MailMessage.cpp
	MailProtocol.cpp
	MailSettings.cpp
	NodeMessage.cpp
	numailkit.cpp
	ProtocolConfigView.cpp
	RemoteStorageProtocol.cpp
	StatusWindow.cpp
	StringList.cpp
;

LinkSharedOSLibs libmail.so :
	be
	textencoding
	tracker
	stdc++.r4
;

if $(TARGET_PLATFORM) = r5 {
	LinkSharedOSLibs libmail.so :
		be
		textencoding
		tracker
		stdc++.r4
	;
} else {
	LinkSharedOSLibs libmail.so :
		be
		textencoding
		tracker
		stdc++.r4
		socket
	;
}

MakeLocate <develop>libmail.so : $(OBOS_STLIB_DIR) ;
RelSymLink <develop>libmail.so : libmail.so ;

Package haiku-maildaemon-cvs :
	libmail.so : 
	boot beos system lib ;
