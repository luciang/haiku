SubDir HAIKU_TOP src kits textencoding libiconv ;

SetSubDirSupportedPlatformsBeOSCompatible ;

# disable warnings we don't want here
TARGET_WARNING_CCFLAGS = [ FFilter $(TARGET_WARNING_CCFLAGS)
	: -Wall -Wmissing-prototypes -Wsign-compare ] ;

SubDirCcFlags
	-DLIBDIR="\\\"/boot/home/config/lib\\\""
	-DENABLE_RELOCATABLE=1
	-DIN_LIBRARY
	-DINSTALLDIR="\\\"/boot/home/config/lib\\\""
	-DNO_XMALLOC
	-Dset_relocation_prefix=libcharset_set_relocation_prefix
	-Drelocate=libcharset_relocate
	-DHAVE_CONFIG_H
	;

SubDirSysHdrs $(SUBDIR) ;

if $(TARGET_PLATFORM) != haiku {
	# Argh! Just for <posix/iconv.h>.
	UseHeaders [ FDirName $(HAIKU_TOP) headers posix ] : true ;
}

SEARCH_SOURCE += [ FDirName $(SUBDIR) libcharset ] ;

StaticLibrary libiconv.a :
	iconv.c
	localcharset.c
	relocatable.c
	;
