SubDir HAIKU_TOP src kits opengl ;

SetSubDirSupportedPlatformsBeOSCompatible ;

UsePrivateHeaders opengl ;

if $(TARGET_PLATFORM) != haiku {
	UseHeaders [ FDirName $(HAIKU_TOP) headers os opengl ] : true ;
		# We need the public GL headers also when not compiling for Haiku.
}


UseHeaders [ FDirName $(SUBDIR) mesa ] ;
UseHeaders [ FDirName $(SUBDIR) mesa main ] ;
UseHeaders [ FDirName $(SUBDIR) mesa glapi ] ;
UseHeaders [ FDirName $(SUBDIR) mesa math ] ;
UseHeaders [ FDirName $(SUBDIR) mesa tnl ] ;
UseHeaders [ FDirName $(SUBDIR) mesa shader ] ;
UseHeaders [ FDirName $(SUBDIR) mesa swrast ] ;
UseHeaders [ FDirName $(SUBDIR) mesa swrast_setup ] ;

SubDirCcFlags 
	-DBEOS_THREADS 
	-DGNU_ASSEMBLER 
	-DUSE_X86_ASM 
	-DUSE_MMX_ASM 
	-DUSE_3DNOW_ASM 
	-DUSE_SSE_ASM ;
SubDirC++Flags 
	-DBEOS_THREADS 
	-DGNU_ASSEMBLER 
	-DUSE_X86_ASM 
	-DUSE_MMX_ASM 
	-DUSE_3DNOW_ASM 
	-DUSE_SSE_ASM ;

SEARCH_SOURCE += [ FDirName $(SUBDIR) mesa $(TARGET_ARCH) ] ;

SharedLibrary libGL.so :
	GLView.cpp
	GLDispatcher.cpp
	GLRenderer.cpp

	# mesa/$(TARGET_ARCH)
	glapi_$(TARGET_ARCH).S
	: 
	# GLU API is included in libGL.so under BeOS R5, not a separate libglu.so library
	<opengl>sgi-glu.o

	# GLUT API is included in libGL.so under Haiku, not a separate libglut.so library
	<opengl>glut.o 

	libmesa.a		# For GL API dispatching, mostly 

	# External libs:
	be 
	game			# BWindowScreen needed by BGLScreen stub class 
;

Package haiku-opengl-cvs :
	libGL.so : 
	boot beos system lib ;

SubInclude HAIKU_TOP src kits opengl glu ;
SubInclude HAIKU_TOP src kits opengl glut ;
SubInclude HAIKU_TOP src kits opengl mesa ;
