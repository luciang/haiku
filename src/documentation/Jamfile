SubDir OBOS_TOP src documentation ;

XSLTPROC ?= xsltproc ;

rule Doc2HTML
{
	local source = [ FGristFiles $(1) ] ;
	local target = $(2) ;
	local xslsheet = $(3) ;
	local basedir = [ FDirName $(OBOS_DISTRO_TARGET) beos documentation $(4) ] ;
	local paths = $(5) ;
	local options = $(6) ;

	if ! $(target) {
		target = $(1:S=.html) ;
	}

	SEARCH on $(source) = $(SEARCH_SOURCE) ;

	MakeLocate $(target) : $(basedir) ;
	if $(2) {
		XSLBASEDIR on $(target) = -stringparam base.dir \"$(basedir)/\" ; 
	}
	XSLSHEET on $(target) = $(xslsheet) ;
	XSLOPTIONS on $(target) = $(options) ;
	if $(2) = "" {
		XSLOUTPUT on $(target) = "-o "\"$(target:D=$(basedir))\" ;
	}

	Depends $(target) : $(source) ;
	LocalDepends doc_files : $(target) ;
	XSLPROCPATHS on $(target) = -path \" $(paths:J=\ ) \" ;
	Doc2HTML1 $(target) : $(source) ;
	LocalClean clean : $(target) ;
}

actions Doc2HTML1
{
	$(XSLTPROC) -xinclude $(XSLPROCPATHS) $(XSLBASEDIR) $(XSLOPTIONS) $(XSLOUTPUT) $(XSLSHEET) $(2)
}

SEARCH on  <src!documentation>license.xml = [ FDirName $(OBOS_TOP) src documentation ] ;

#SubInclude OBOS_TOP src documentation haiku_book ;
SubInclude OBOS_TOP src documentation shell_tools ;
