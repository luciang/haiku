SubDir OBOS_TOP src system runtime_loader ;

UsePrivateHeaders runtime_loader ;

KernelObjects 
	rld.c
	rldexport.c
	rldelf.c
	rldheap.c
	rldaux.c
	: -fpic ;

KernelStaticLibraryObjects librld.a :
	# needed for rld.so only
	<src!system!libroot!os>syscalls.o
	<src!system!libroot!os>sem.o
	<src!system!libroot!os!arch!$(OBOS_ARCH)>atomic.o
	<src!system!libroot!os!arch!$(OBOS_ARCH)>thread.o

	<src!system!libroot!posix>errno.o

 	<src!system!libroot!posix!glibc!ctype>ctype-info.o
	<src!system!libroot!posix!glibc!locale>C-ctype.o
	<src!system!libroot!posix!glibc!locale>C_name.o
  	<src!system!libroot>kernel_vsprintf.o
  	<src!system!libroot!posix!unistd>open.o

	<src!system!libroot!posix!string>memchr.o
	<src!system!libroot!posix!string>memcmp.o
	<src!system!libroot!posix!string>memcpy.o
	<src!system!libroot!posix!string>memmove.o
	<src!system!libroot!posix!string>memset.o
	<src!system!libroot!posix!string>strcasecmp.o
	<src!system!libroot!posix!string>strcat.o
	<src!system!libroot!posix!string>strchr.o
	<src!system!libroot!posix!string>strcmp.o
	<src!system!libroot!posix!string>strcpy.o
	<src!system!libroot!posix!string>strcspn.o
	<src!system!libroot!posix!string>strdup.o
	<src!system!libroot!posix!string>strerror.o
	<src!system!libroot!posix!string>strlcat.o
	<src!system!libroot!posix!string>strlcpy.o
	<src!system!libroot!posix!string>strlen.o
	<src!system!libroot!posix!string>strncmp.o
	<src!system!libroot!posix!string>strnlen.o
	<src!system!libroot!posix!string>strpbrk.o
	<src!system!libroot!posix!string>strrchr.o
	<src!system!libroot!posix!string>strspn.o
	<src!system!libroot!posix!string>strstr.o
	;

KernelLd rld.so :
	<$(SOURCE_GRIST)>rld.o
	<$(SOURCE_GRIST)>rldelf.o
	<$(SOURCE_GRIST)>rldexport.o
	<$(SOURCE_GRIST)>rldheap.o
	<$(SOURCE_GRIST)>rldaux.o
	librld.a
	: $(SUBDIR)/arch/$(OBOS_ARCH)/rld.ld
	:
	:
	: beos/system/lib/rld.so
	;
