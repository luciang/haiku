SubDir HAIKU_TOP src system kernel arch x86 ;

SubDirHdrs [ FDirName $(TARGET_COMMON_DEBUG_OBJECT_DIR) system kernel ] ;
	# for syscall_numbers.h
SubDirHdrs $(HAIKU_TOP) src add-ons kernel bus_managers ps2 ;
SubDirHdrs $(SUBDIR) $(DOTDOT) generic ;

UsePrivateHeaders kernel [ FDirName kernel arch $(TARGET_ARCH) ] 
	[ FDirName kernel boot platform $(HAIKU_BOOT_PLATFORM) ] ;

SEARCH_SOURCE += [ FDirName $(SUBDIR) $(DOTDOT) generic ] ;

KernelStaticLibrary libx86 :
	arch_cpu.c
	arch_debug.c
	arch_debug_console.c
	arch_elf.c
	arch_int.c
	arch_platform.c
#	arch_selector.c
	arch_real_time_clock.c
	arch_smp.c
	arch_thread.c
	arch_timer.c
	arch_vm.c
	arch_vm_translation_map.c
	arch_x86.S
	arch_interrupts.S
	arch_system_info.c
	arch_user_debugger.cpp
	apm.cpp
	bios.cpp
	cpuid.S

	generic_vm_physical_page_mapper.cpp
	:
	$(TARGET_KERNEL_PIC_CCFLAGS) -Wno-unused
;

# We need to specify the dependency on the generated syscalls file explicitly.
Includes [ FGristFiles arch_x86.S arch_interrupts.S ]
	: <syscalls>syscall_numbers.h ;
