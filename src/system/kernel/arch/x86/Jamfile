SubDir OBOS_TOP src system kernel arch x86 ;

# for syscall_numbers.h
SubDirHdrs [ FObjectsDir src system kernel ] ;

KernelStaticLibrary libx86 :
	arch_cpu.c
	arch_debug.c
	arch_debug_console.c
	arch_elf.c
	arch_int.c
#	arch_selector.c
	arch_real_time_clock.c
	arch_smp.c
	arch_thread.c
	arch_timer.c
	arch_vm.c
	arch_vm_translation_map.c
	arch_x86.S
	arch_interrupts.S
	arch_system_info.c
	arch_user_debugger.cpp
	bios.cpp
	cpuid.S
	:
	-fno-pic -Wno-unused
	;

# We need to specify the dependency on the generated syscalls file explicitly.
Includes [ FGristFiles arch_x86.S arch_interrupts.S ]
	: <syscalls>syscall_numbers.h ;
