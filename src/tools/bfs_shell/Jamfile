SubDir HAIKU_TOP src tools bfs_shell ;

SEARCH_SOURCE += [ FDirName $(HAIKU_TOP) src add-ons kernel file_systems bfs ] ;

# set some additional defines
{
	local defines =
		#BFS_BIG_ENDIAN_ONLY
		BFS_SHELL
		;

	if $(DEBUG) = 0 {
		# the gcc on BeOS doesn't compile BFS correctly with -O2 or more
		OPTIM = -O1 ;
	}

	defines = [ FDefines $(defines) ] ;
	SubDirCcFlags $(defines) -Wall -Wno-multichar ;
	SubDirC++Flags $(defines) -Wall -Wno-multichar -fno-rtti ;
}

local libHaikuCompat ;
if $(HOST_PLATFORM_BEOS_COMPATIBLE) && ! $(HOST_PLATFORM_HAIKU_COMPATIBLE) {
	libHaikuCompat = libhaikucompat_build.a ;
}

UsePrivateHeaders fs_shell ;

BuildPlatformMain <build>bfs_shell
	:
	BlockAllocator.cpp
	BPlusTree.cpp
	Attribute.cpp
	Debug.cpp
	Index.cpp
	Inode.cpp
	Journal.cpp
	Query.cpp
	Utility.cpp
	Volume.cpp

	kernel_interface.cpp

	: <build>fs_shell.a $(libHaikuCompat) $(HOST_LIBSUPC++) $(HOST_LIBSTDC++)
	  $(HOST_LIBROOT)
;
