SubDir HAIKU_TOP src add-ons kernel drivers input usb_hid ;

SetSubDirSupportedPlatformsBeOSCompatible ;

SubDirSysHdrs $(HAIKU_TOP) headers os drivers ;
UsePrivateHeaders [ FDirName kernel util ] input ;

local buffer_impl = ;
if $(TARGET_PLATFORM) != haiku {
	buffer_impl = ring_buffer.cpp ;
}

KernelAddon usb_hid : kernel drivers bin :
	hid.c
	hidparse.c
	devlist.c
	$(buffer_impl)
;

SEARCH on [ FGristFiles ring_buffer.cpp ] = [ FDirName $(HAIKU_TOP) src system kernel util ] ;

ObjectHdrs [ FGristFiles hid$(SUFOBJ) ]
	: [ FDirName $(TARGET_COMMON_DEBUG_OBJECT_DIR) preferences devices ] ;

Includes [ FGristFiles hid.c ] :
	<src!preferences!devices>usbdevs.h <src!preferences!devices>usbdevs_data.h ;

Package haiku-inputkit-cvs :
        usb_hid :
        boot home config add-ons kernel drivers bin ;

PackageDriverSymLink haiku-inputkit-cvs : input usb_hid ;

