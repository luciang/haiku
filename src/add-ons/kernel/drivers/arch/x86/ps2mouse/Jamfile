SubDir OBOS_TOP src add-ons kernel drivers arch x86 ps2mouse ;

if $(COMPILE_FOR_R5) {
	SubDirCcFlags -DCOMPILE_FOR_R5 ;
}

UsePrivateHeaders input kernel ;

KernelObjects
	ps2mouse.c
	:
	-fno-pic -D_KERNEL_MODE -D_PS2MOUSE_
	;

KernelLd ps2mouse :
	<$(SOURCE_GRIST)>ps2mouse.o
	kernel.so
	:
	$(OBOS_TOP)/src/kernel/ldscripts/$(OBOS_ARCH)/add-on.ld
	:
	-Bdynamic -shared
	:
	:
	drivers/dev/ps2mouse
	; 

R5KernelAddon <driver>ps2mouse : kernel drivers bin :
	ps2mouse.c
;

# Link to kernel/drivers/dev/input
{
	local dir = [ FDirName $(OBOS_ADDON_DIR) kernel drivers dev input ] ;
	local instDriver = <kernel!drivers!dev!input>ps2mouse ;
	MakeLocate $(instDriver) : $(dir) ;
	RelSymLink $(instDriver) : <driver>ps2mouse ;
}

#Package haiku-inputkit-cvs
#	:
#	<driver>ps2mouse
#	:
#	boot home config add-ons kernel drivers bin ;

#Package haiku-inputkit-cvs
#	:
#	<kernel!drivers!dev!input>ps2mouse
#	:
#	boot home config add-ons kernel drivers dev input ;

