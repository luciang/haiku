SubDir HAIKU_TOP src add-ons media plugins ffmpeg libswscale ;

SubDirHdrs [ FDirName $(SUBDIR) .. ] ;
SubDirHdrs [ FDirName $(SUBDIR) ../libavutil ] ;
SubDirHdrs [ FDirName $(SUBDIR) ../libavcodec ] ;

# filter warnings we don't want here
TARGET_WARNING_CCFLAGS = [ FFilter $(TARGET_WARNING_CCFLAGS)
	: -Wall -Wmissing-prototypes -Wsign-compare -Wpointer-arith ] ;

local archSources ;
archSources = ;

if $(TARGET_ARCH) = x86 {
} else if $(TARGET_ARCH) = ppc {
    archSources = yuv2rgb_altivec.c ;
    SubDirCcFlags -maltivec -mabi=altivec ;
} else if $(TARGET_ARCH) = sparc {
    archSources = yuv2rgb_vis.c ;
}

SubDirCcFlags $(HAIKU_FFMPEG_GCC_EXTRA_FLAGS) ;
SubDirCcFlags $(HAIKU_FFMPEG_DEFINES) ;
SubDirC++Flags $(HAIKU_FFMPEG_DEFINES) ;

StaticLibrary libswscale.a :
	rgb2rgb.c
	swscale.c
	swscale_avoption.c
	yuv2rgb.c

    $(archSources)
;
